## 1.1. Архитектура и принцип работы FSK– модема

Передача цифровых данных по линиям связи осуществляется с использованием модемов (модулятор-демодулятор). При этом цифровой сигнал преобразуется в аналоговый определенным образом. 
Основные функции модема:
1.	обработка команд от host-процессора (взаимодействие с РС);
2.	операции скремблирования (кодирования) и дискретизации информации;
3.	набор номера;
4.	синхронизация работы модулятора и демодулятора;
5.	определение и управление конфигурацией модема;
6.	поддержка определенного протокола.

В структуре модема можно выделить следующие основные блоки:
1.	интерфейс с host-процессором;
2.	контроллер модема;
3.	DSP-процессор;
4.	аналоговая часть, подключаемая к телефонной линии.

![image1][id1]

Каждый модем состоит из двух основных частей: модулятора и демодулятора.
Принцип работы модулятора заключается в формировании сигнала одной или другой частоты в зависимости от передаваемой информации. В аналоговых модемах в зависимости от передаваемой информации к выходу устройства подключался один из двух генераторов.

![image1][id2]

Недостатком данного метода является наличие перепадов напряжения при переключении генераторов, так как они никак между собой не синхронизированы. Это приводит к появлению в сигнале дополнительных гармонических составляющих, что затрудняет демодуляцию сигнала.Основная задача демодулятора – определить частоту сигнала, принимаемого в данный момент времени. При использовании аналоговой техники это можно сделать с помощью двух полосовых фильтров, интеграторов и пороговых схем.

## 1.2.Архитектура и принцип работы FSK– модема(продолжение)

![image1][id3]

Недостатком такого метода детектирования является то, что трудно получить высокую скорость передачи данных из-за небольшой разницы часто «0» и «1». Для хорошего разделения частот требуются фильтры с высокой добротностью и узкой полосой пропускания. Но такие фильтры требуют большую длительность сигнала для исключения переходных процессов, что и приводит к снижению скорости передачи данных.
Все вышеперечисленные недостатки аналоговых схем модема легко устраняются при использовании цифровой техники. Для синхронизации приемника и передатчика передаваемая информация должна сопровождаться битами синхронизации. При отсутствии передачи в линию обычно выдается сигнал с частотой, соответствующей «1» (стоповые биты). Начало передачи информации сопровождается одним нулевым (стартовым битом) за которым следуют биты данных. Получение стартового бита приемником запускает его на прием информации. Передача информации может заканчиваться контрольным битом для проверки правильности передачи. И последним передается один или два стоповых бита, разделяющих передачу двух слов данных.

## 2. Построение модулятора FSK – модема

В основе работы модулятора лежит следующее соотношение:

![equation1][logo1]

## 2. Построение модулятора FSK – модема(продолжение)
 
## 3. Построение демодулятора FSK – модема

## 4. Структура лабораторного макета TMS 320C5xSTARTERKIT

Лабораторный макет построен на базе процессора TMS320C50 и аналогового интерфейса (АИ) TLC32040. Структурная схема макета представлена на рисунке:

![image1][id7]

В состав макета входит также кварцевый генератор частотой 40 МГц, ПЗУ (PROM) для загрузки программного ядра емкостью 32К байт (27PC256FM) и преобразователь напряжения. Макет выполнен в виде отдельной платы и подключается к ПЭВМ типа IBM PC через интерфейс RS-232. Питание макета осуществляется от внешнего источника переменного напряжения ±9В, которое преобразуется в постоянные напряжения +9В и –9В (для питания последовательного интерфейса), а также в стабилизированное напряжение +5В и –5В (для питания цифровых схем). Для сопряжения TTL-уровней микросхемы процессора с уровнями интерфейса RS-232 используются две микросхемы преобразователей уровня сигналов (75188 и 75189). Макет имеет также пять разъемов для подключения к шине TMS дополнительного оборудования, два разъема для ввода и вывода аналоговых сигналов, разъем для интерфейса RS-232 и разъем питания.

Поскольку АИ подключается к макету через последовательный интерфейс, то для связи с ПЭВМ используются программно управляемые выводы процессора XF и BIO, а поскольку макет не имеет внешней памяти данных, то вывод управления глобальной памятью BR используется для сброса АИ и выбора PROM.

Внутреннее ПЗУ программ процессора содержит программу-загрузчик для загрузки программы-монитора (программного ядра) из PROM в макет, которая служит для управления и отладки пользовательских программ.

Пользовательские программы загружаются в блок SARAM, сконфигурированный как память программ и данных. При этом часть памяти занята под программное ядро.
Для обмена информацией с АИ используются регистры последовательного интерфейса TMS320C50 - передатчика DXR и приемника DRR.


## 5.1 Лабораторный макет на базе процессора TMS320VC5402

Модуль DSK (DigitalSignalprocessorstarterKit – Базовый набор инструментов для ЦПС) обеспечивает дешевую автономную платформу для проектирования различных приложений для ЦПС C54x. DSK также служит пособием по аппаратным средствам. Схемные решения DSK, логику управления и описания применения можно использовать для облегчения и ускорения аппаратных и программных разработок при минимальных затратах на проектирование.
Обобщенная структурная схема модуля DSK представлена на рис. 6.11.

![image1][id8]

Модуль DSK включает следующие основные блоки:
* 100 МГц ЦПС TMS320VC5402
* 64 К слов внешней SRAM с одним тактом ожидания
* 256 К словфлэш-памяти
* JTAG (JointTestAutomationGroup – Объединенная рабочая Группа по Автоматизации Тестирования) контроллер испытательной шины для эмуляции
* HPI интерфейс, соединенный с параллельным портом главного компьютера
* Телефонный интерфейс с DAA (DataAccessArrangement – Механизм Доступа к Данным)
* АудиоинтерфейсМикрофон/Динамик
* Интерфейс RS-232 с UART (Universal Asynchronous Receiver / Transmitter)
* Расширение интерфейса памяти и внешних устройств для дополнительной платы (два разъема)

DSK – автономная плата, которая требует только питание +5 В от внешнего источника питания, входящего в комплект поставки. Линейные стабилизаторы напряжения на плате обеспечивают 1.8 В напряжение питание ядра процессора, 3.3 В цифрового и 5 В аналогового напряжения питания.

ЦПС соединяется с внешней SRAM, флэш-памятью и разъемом интерфейса расширения памяти через 16-разрядный Внешний Интерфейс Памяти (EMIF).Аналоговый интерфейс DAA и микросхема AD50 обеспечивают ЦПС доступ к одиночному телефонному интерфейсу через один из Многоканальных Буферизированных Последовательных Портов (МкБПП) – McBSP0. McBSP0 может быть также соединен с разъемом расширения, что задается программно.

## 5.2 Лабораторный макет на базе процессора TMS320VC5402

Интерфейс микрофона и динамика (через 3.5мм Звуковые Разъемы) обеспечивается второй микросхемой AD50, которая соединена со вторым МкБПП (McBSP1). McBSP1, наряду с сигналами двух таймеров и внешнего прерывания, также подключен к разъему расширения, что позволяет использовать дополнительную внешнюю плату.
Общая синхронизация работы всего модуля обеспечивается CPLD (CentralProgrammableLogicDevice – Центральное Программируемое Логическое Устройство).

Управление DSK обеспечивается 8-позиционным переключателем для задания внешних опций пользователя. Кнопка позволяет вручную сбросить DSK. Супервизор напряжения питания контролирует внутренне сгенерированное напряжение и сбрасывает плату, при выходе его за заданные пределы. Четыре светодиода обеспечивают индикацию включения питания и три управляемых пользователем индикатора.

## 6.1. Функциональная схема аналогового интерфейса TLC320AD50C

Аналоговый интерфейс TLC320AD50C (50I и 52C) обеспечивает преобразование сигнала с высоким разрешением из цифрового в аналоговый (D/A) и из аналогового в цифровой (A/D) с использованием технологии сигма-дельта модуляции. Архитектура с сигма-дельта модуляцией обеспечивает А/Ц и Ц/А преобразование с высоким разрешением при низкой стоимости системы.Функциональная схема устройства аналогового интерфейса представлена на рис:

![image1][id9]

Устройство состоит из следующих основных блоков:

* 16-разрядный сигма-дельта АЦП
* 16-разрядный сигма-дельта ЦАП
* Фильтр для децимации после АЦП
* Интерполирующий фильтр перед ЦАП
* Сглаживающий фильтр нижних частот после ЦАП
* Последовательный интерфейс со схемой управления и выходным буфером
* Внутренний источник опорного напряжения (Vref)
* Внутренняя схема фазовой автоподстройки частоты (PLL) с делителем
* Внутренние цепи синхронизации	
* Усилители с программируемым коэффициентом усиления (PGA)
* Аналоговые цепи обратной связи
* Цифровые цепи обратной связи
* Два входны хмультиплексора

## 6.2. Функциональная схема аналогового интерфейса TLC320AD50C

Основные возможности и технические характеристики устройства:

*	Универсальная схема аналогового интерфейса для модема V. 34+ и различных аудио приложений
*	16-разрядные сигма-дельта АЦП и ЦАП
*	Последовательный интерфейс
*	Типовое значение SNR (отношение сигнал/шум) для АЦП и ЦАП равно 89dB
*	Типовое значение THD (суммарное значение коэффициента нелинейных искажений) для АЦП и ЦАП равно 90 dB
*	Типовое значение динамического диапазона 88 dB
*	Тестовый режим, включающий цифровой и аналоговый петлевой тесты
*	Программируемая частота А/Ц и Ц/А преобразования
*	Максимальная частота преобразования: 22.05 кГц
*	Программируемая регулировка уровня на входе и выходе
*	Одно напряжение питания 5 В или 5 В аналоговое и 3 В цифровое напряжение питания
*	Типовая рассеиваемая мощность в рабочем режиме (PD) 120 мВт (СКЗ)
*	Аппаратный режим пониженного энергопотребления до 7.5 мВт
*	Внутреннее опорное напряжение (Vref)
*	Дифференциальная архитектура всего устройства
*	TLC320AD50C/I может поддерживать до трех подчиненных устройств; TLC320AD52C до одного
*	Формат данных – двоичный дополнительный код
*	Вывод ALTDATA обеспечивает текущий контроль данных
*	Контроль усилителя для контроля входных сигналов
*	Внутренняя фазовая автоподстройка частоты (PLL)

Программируемые функции этого устройства могут быть выбраны через последовательный интерфейс. Они включают сброс, выключение, протокол связи, частоту дискретизации сигнала, регулировку уровня и тестовые режимы системы.
Передача данных всегда выполняется при первичной связи главного устройства со схемой. Так как устройство работает синхронно, передача слова данных из канала АЦП и в канал ЦАП происходит одновременно.

## 7.1. Подключение аналогового интерфейса TLC320AD50C к процессору.

При подключении нескольких устройств они соединяются последовательно, при этом первый является ведущим, а остальные ведомыми (рис. 6.14).

![image1][id10]

Выход FSD ведущего поступает на первый ведомый, выход FSD первого ведомого – на второй ведомый и так далее. Выход FSD предыдущего устройства соединяется со входом FS следующего. Последовательность FSD импульсов в режиме ведомого следующая:
*	когда данные в регистре FSD = 0, FSD переходит в низкое состояние на 1/4 периода SCLK, прежде чем FS станет низким.
*	когда данные в регистре FSD больше чем 17, FSD переходит в низкое состояние по восходящему фронту SCLK, равному номеру в регистре FSD, после спадающего фронта FS (см. рис. 6.15). Значенияданныхот 1 до 17 недолжныиспользоваться.

## 7.2. Подключение аналогового интерфейса TLC320AD50C к процессору

При подключении нескольких устройств они соединяются последовательно, при этом первый является ведущим, а остальные ведомыми (рис. 6.14).

![image1][id11]

Цифровой последовательный интерфейс состоит из сигнала сдвига (SCLK), кадрового синхросигнал (FS), выхода данных канала АЦП (DOUT) и входа данных канала ЦАП (DIN). В течение первичного интервала синхронизации кадра SCLK синхронизирует результаты канала АЦП, выдаваемые через DOUT, и синхронизирует 16-разрядные / (15+1)-разрядные данные ЦАП, принимаемые через DIN.
В течение вторичного интервала синхронизации кадра SCLK синхронизирует данные чтения регистра через DOUT, если бит чтения (DS13) установлен в 1, и передает команды и параметры устройства через DIN. Передачаначинаетсясостаршегобита (DS15).

## 8.1. Управление аналоговым интерфейсом TLC 320 AD 50C

Для передачи управляющей информации в устройство через DIN и чтения состояния устройства через DOUT используется вторичная связь. При этом передача данных происходит по аппаратному или программному запросу.
Схема имеет семь регистраторов управления, которые используются следующим образом: Регистр 0 Регистр пустой команды. Адресация регистра 0 позволяет при вторичной связи не изменить состояние никакого другого регистра.
Регистр 1 Регистр управления 1. Данные в этом регистре управляют:
*	Программным сбросом и снижением энергопотребления
*	Подключением основных или дополнительных аналоговых входов
*	Контролем основных или дополнительных аналоговых входов и выбором коэффициента усиления усилителя контрольного выхода
*	Выбором цифровой обратной связи
*	Выбор 16- или (15 + 1) разрядного режима работы ЦАП
Регистр 2 Регистр управления 2. Данные в этом регистре:
*	Содержат выходное значение бита FLAG
*	Выбирают режим телефона
*	Содержат флажок переполнения децимирующего FIR фильтра
*	Выбирают 16- или (15 + 1) разрядный режим работы АЦП
*	Разрешают аналоговую обратную связь
Регистр 3 Регистр управления 3. Данные в этом регистре:
*	Устанавливают число тактов SCLK, задающих задержку между FS и FSD
*	Указывает ведущему, сколько ведомых подсоединены к нему в цепочке
Регистр 4 Регистр управления 4. Данные в этом регистре:
*	Выбирают коэффициенты усиления для входного и выходного усилителей
*	Устанавливают частоту дискретизации, выбирая величину N от 1 до 8, при этом fs = MCLK / (128 × N) или MCLK / (512 × N)
*	Выбирают ФАПЧ (PLL). Если PLL выбран – частота дискретизации будет равна (MCLK × 4) / (512 × N). Если PLL обходится – частота дискретизации устанавливается MCLK / (512 × N).
Регистр 5 Зарезервирован для теста производителем. Не пишите в этот регистр.
Регистр 6 Зарезервирован для теста производителем. Не пишите в этот регистр.

Частота сдвига SCLK получается из частоты дискретизации fs, а не MCLK следующим образом: SCLK = 256 × fs 
Частота среза фильтра не может управляться программированием регистра. Характеристика фильтра приводится для частоты дискретизации 8 кГц. Ширина полосы пропускания изменяется линейно и пропорционально частоте дискретизации.
Программирование всех регистров происходит в течение вторичной связи через вход DIN и данные защелкиваются и являются действительными на спадающем фронте SCLK в течение синхросигнала кадра. Если значение по умолчанию для отдельного регистра является соответствующим, то этот регистр не должен быть адресован в течение вторичного интервала связи. Пустая команда (DS15-DS8 все равны 0) адресует псевдорегистр (регистр 0) и в течение связи никакого программирования регистров не происходит.
Кроме того, любой регистр может быть прочитан через DOUT в течение вторичной связи установкой бита чтения (DS13) в 1. Когда регистр находится в режиме чтения, никакие данные не могут быть записаны в регистр в течение этого цикла. DS13 должен быть очищен, чтобы записать в регистр.

## 8.2. Управление аналоговым интерфейсом TLC 320 AD 50C

[id1]: http://ow.ly/A2oC9 " Структурная схема модема"
[id2]: http://ow.ly/A2oMw " Модулятор аналогового модема "
[id3]: http://ow.ly/A2oWl "Демодулятор аналогового модема"
[id7]: http://ow.ly/A2oqU " Структура лабораторного макета TMS 320C5xSTARTERKIT "
[id8]: http://ow.ly/A2o7X " Лабораторный макет на базе процессора TMS320VC5402"
[id9]: http://ow.ly/A2nY2 " Функциональная схема устройства аналогового интерфейса"
[id10]: http://ow.ly/A2nvR "Каскадное соединение микросхем TLC320AD50C"
[id11]: http://ow.ly/A2nfQ " Временная диаграмма работы микросхем TLC320AD50C "

[logo1]: http://ow.ly/A2pfC " S(t) = \cos[(\omega _{c}\pm \delta _{\omega })t+\varphi ] " 
